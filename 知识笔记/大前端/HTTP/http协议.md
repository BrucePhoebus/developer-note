# http协议

## HTTP入门

#### HTTP历史

	1991年HTTP/0.9 --> 1996年HTTP/1.0 --> 2015年HTTP/2

###### HTTP/0.9

	最早版本是1991年发布的0.9版。该版本极其简单，只有一个命令GET

```html
GET /index.html
```

* 上面命令表示，TCP 连接（connection）建立后，客户端向服务器请求（request）网页index.html。

* 协议规定，服务器只能回应HTML格式的字符串，不能回应别的格式

> 服务器发送完毕，就关闭TCP连接

#### HTTP/1.x

	这个版本主要是HTTP/1.0和HTTP/1.1，目前一直用到现在，其内容也是极其丰富，基本满足互联网大部分需求实现

1. 任何格式的内容都可以发送。这使得互联网不仅可以传输文字，还能传输图像、视频、二进制文件（这是互联网的基础）。

2. 丰富请求方式。GET命令、POST命令和HEAD命令。

3. 完善了请求头和响应格式。除了数据部分，每次通信都必须包括头信息（HTTP header），用来描述一些元数据。

4. 其他。状态码（status code）、多字符集支持、多部分发送（multi-part type）、权限（authorization）、缓存（cache）、内容编码（content encoding）等。。。

> 请求格式、响应格式、Content-Type 字段、Content-Encoding 字段

###### HTTP/1.1

1. 持久连接

2. 管道机制

3. Content-Length 字段

4. 分块传输编码

5. 其他。完善请求方式：PUT、PATCH、HEAD、 OPTIONS、DELETE

!> 依旧存在的问题：依旧存在请求响应慢和请求阻塞的问题

	一是减少请求数，二是同时多开持久连接。
	这导致了很多的网页优化技巧，比如合并脚本和样式表、将图片嵌入CSS代码、域名分片（domain sharding）等等

#### HTTP/2

	不存在HTTP/2.x，应该只有一个版本，之后便是3了

1. 二进制协议

	HTTP/2 则是一个彻底的二进制协议，头信息和数据体都是二进制，并且统称为"帧"（frame）：头信息帧和数据帧。

	二进制协议的一个好处是，可以定义额外的帧。HTTP/2 定义了近十种帧，比起文本解析的麻烦问题，二进制解析起来方便很多

2. 多工

	复用TCP连接。在一个连接里，客户端和浏览器都可以同时发送多个请求或回应，避免"队头阻塞"

	双向的、实时的通信，就叫做多工（Multiplexing）

3. 数据流

	HTTP/2数据传输是以无序数据包组成，每个数据包都有标识，而HTTP/2 将每个请求或回应的所有数据包，称为一个数据流（stream）

> HTTP/2 可以取消某一次请求，同时保证TCP连接还打开着，可以被其他请求使用

> 客户端还可以指定数据流的优先级。优先级越高，服务器就会越早回应

4. 头信息压缩

	HTTP/2 引入了头信息压缩机制（header compression）。
	一方面，头信息使用gzip或compress压缩后再发送；
	另一方面，客户端和服务器同时维护一张头信息表，所有字段都会存入这个表，生成一个索引号，以后就不发送同样字段了，只发送索引号，这样就提高速度了。

5. 服务器推送

	HTTP/2 允许服务器未经请求，主动向客户端发送资源，这叫做服务器推送（server push）

**常见场景**

	客户端请求一个网页，这个网页里面包含很多静态资源。正常情况下，客户端必须收到网页后，解析HTML源码，发现有静态资源，再发出静态资源请求。其实，服务器可以预期到客户端请求网页后，很可能会再请求静态资源，所以就主动把这些静态资源随着网页一起发给客户端了。

> [HTTP协议入门](http://www.ruanyifeng.com/blog/2016/08/http.html)

